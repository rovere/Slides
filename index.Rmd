---
title       : Latest developments in phase2 geometry description and navigation
subtitle    : Upgrade TP Performance Studies group Meeting, 2014-06-05
author      : M. Rovere, K. Stenson, G. Cerati for Andrea Vanturi
job         : CERN
framework   : io2012        # {io2012, html5slides, shower, dzslides, ...}
highlighter : prettify      # {highlight.js, prettify, highlight}
hitheme     : twitter-bootstrap # sunburst      #
widgets     : [mathjax]            # {mathjax, quiz, bootstrap}
mode        : selfcontained # {standalone,draft}

--- .bigger

## Summary of changes

* Details available in [Andrea's
  talk](https://indico.cern.ch/event/305423/session/3/contribution/4/material/slides/1.pdf)
* Main improvements in
    * Geometry/TrackerNumberingBuilder
    * RecoTracker/TkDetLayers
* All contained in pending PR
  [4108](https://github.com/cms-sw/cmssw/pull/4108), few of them
  already included in SLHC13.

--- .smaller

## Changes in Geometry/TrackerNumberingBuilder

* Mostly transparent and to improve the modularity of the package
    * Many "if" moved away from the algorithmic part of the code and classes split to cope with different geometry elements
    * The "navigation" into the geometry is based upon:
        * GeometricDet name
            * If this is an accepted solution we have to ensure, in future, that elements with different geometries have different names
        * Number of blades
            * As it has been so far
* Fixes of the FPIX geometry
    * inner and outer ring assignment
        * Mean radius is now hardcoded in the software ...
    * $\phi$ offset
    * These fixes are already in SLHC13
* CmsTrackerDiskBuilder split into:
    * CmsTrackerDiskBuilder (present detector)
    * CmsTrackerPhase1DiskBuilder (phase 1 detector)
    * CmsTrackerOTDiscBuilder (phase 2 OT endcaps)
* CmsTrackerPanelBuilder split into:
    * CmsTrackerPanelBuilder
    * CmsTrackerOTRingBuilder

--- .smaller

## Changes in RecoTracker/TkDetLayers

* Similar approach as for the Geometry: split the code to have different algorithms in different classes
    * Same GeometricDet names used to navigate in the geometry
* PixelBarrelLayer(Builder) split into
    * PixelBarrelLayer(Builder) (pixel detector)
    * Phase2OTBarrelLayer(Builder) (phase 2 OT barrel)
* Phase2OTBarrelRod(Builder) newly created
    * Phase 2 outer tracker barrel navigation inspired by TOB navigation: recovered overlap in z
    * Second pt module compatibility inherited from the first one: we can do better!
* PixelForwardLayer(Builder) split into
    * PixelForwardLayer(Builder)
    * Phase2OTECRingedLayer(Builder)
* Phase2OTECRing(Builder) newly created
    * Phase 2 outer tracker disk navigation inspired by TID navigation: ring geometry properly taken into account, including overlaps
    * Second pt module compatibility inherited from the first one: it seems to work fine
* PixelBlade cleaned up
* Inner/outer FPIX ring definition already fixed in SLHC13


--- .smaller &fourboxes w1:50 w2:50 w3:50 w4:50 imageleft_up:images/FractionOfHitsOnTrackFPIX.png imageright_up:images/FractionOfHitsOnTrackTEC.png imageright_down:images/FractionOfHitsOnTrackTOB.png

## Results: on track hit fraction

*** =caption_left_up

Fraction of hits On-Track in the Pixel Forward Detector.

*** =caption_right_up

Fraction of hits On-Track in the TEC: here the recovery of the hits on track is dramatic.

*** =caption_right_down

Fraction of hits On-Track in TOB.

*** =textleft_down

* <font class="red">SLHC12</font>, <font class="blue">SLHC13</font> and SLHC13+this PR in 10-$\mu$ events.
* In 10-muon events:
    * FPIX recovered in SLHC13
    * TEC: big improvement
    * Barrel: it is better but still problem with shallow angle tracks
        * The compatibility for the two modules has to be tested independently

--- &fourimages w1:25 w2:25 w3:25 w4:25 imageleft_most:images/TEC_PS_SLHC13.png imageleft:images/TEC_PS_New.png imageright:images/TEC_2S_SLHC13.png imageright_most:images/TEC_2S_New.png

## Occupancy maps: 10 muons

*** =caption_left_most
TEC PS Module - SLHC13

*** =caption_left
TEC PS Module - New

*** =caption_right
TEC 2S - SLHC13

*** =caption_right_most
TEC 2S - New

--- &fourboxes w1:50 w2:50 w3:50 w4:50 imageleft_up:images/EtaPhiOccupancyNew.png imageright_up:images/EtaPhiOccupancySLHC13.png imageright_down:images/EtaPhiOccupancySLHC12.png

## Number of Hits in 10 $\mu$ sample

*** =caption_left_up

New Occupancy map

*** =caption_right_up

SLHC13 occupancy map

*** =caption_right_down

SLHC12 occupancy map

*** =textleft_down

* The improvements in the occupancy map in the $\eta-\phi$ plane is
  cleary visible in going from SLHC12 to SLHC13 to the New proposed
  changes.

--- &twoimages w1:50 w2:50 imageleft:images/hits_mupt100_afix_eta.png imageright:images/trkeff_mupt100pu0_afix_eta_hp.png

## Comparison between releases&bug fixes

*** =bottom_text

* SLHC12: plain SLHC12 with GEN-SIM and DIGI also done in SLHC12

* <font class="blue">SLHC12 + Andrea fix = SLHC12 +
  venturia:navigation_cleanup and reusing the DIGI from the previous
  step.</font>

* <font class="red">SLHC13 + Andrea fix = SLHC13_patch1 +
  venturia:navigation_cleanup-SLHC13 with GEN-SIM and DIGI done in the
  same release.</font>

--- &twoimages w1:50 w2:50 imageleft:images/trkfake_ttbar_afix_eta_hp.png imageright:images/trkeff_ttbar_afix_eta_hp.png

## Comparison between releases&bug fixes

*** =bottom_text

* SLHC12: plain SLHC12 with GEN-SIM and DIGI also done in SLHC12

* <font class="blue">SLHC12 + Andrea fix = SLHC12 +
  venturia:navigation_cleanup and reusing the DIGI from the previous
  step.</font>

* <font class="red">SLHC13 + Andrea fix = SLHC13_patch1 +
  venturia:navigation_cleanup-SLHC13 with GEN-SIM and DIGI done in the
  same release.</font>

--- &twoimages w1:50 w2:50 imageleft:images/ptresvseta_mupt100_afix.png imageright:images/trkdup_ttbar_afix_eta_hp.png

## Comparison between releases&bug fixes

*** =bottom_text

* SLHC12: plain SLHC12 with GEN-SIM and DIGI also done in SLHC12

* <font class="blue">SLHC12 + Andrea fix = SLHC12 +
  venturia:navigation_cleanup and reusing the DIGI from the previous
  step.</font>

* <font class="red">SLHC13 + Andrea fix = SLHC13_patch1 +
  venturia:navigation_cleanup-SLHC13 with GEN-SIM and DIGI done in the
  same release.</font>

--- &twoimages w1:50 w2:50 imageleft:images/TrackerOccupancySameClusterOntrackMap_SLHC12.png imageright:images/TrackerOccupancySameClusterOntrackMap_SLHC12Fixes.png

## Comparison between releases&bug fixes

*** =caption_left
Plain SLHC12 Release

*** =caption_right
Plain SLHC12 Release+proposed fixes

---

## Conclusions

* Many pending problems that were fixed/hacked in the past got finally
  fixed in a more appropriate way.

* We would like to have these changes used for the Technical Proposal
  performance plots since no problems have been found in independent
  tests

    * Full production chain with these changes
    * Tracking efficiency, fake rate and momentum resolution
    * Fraction of hits which are used more than once: there should be none

* The code seems to be more compatible to be integrated in 71x
    * If the geometry element names are chosen properly upgrade and present detector classes are completely independent

* Pushed for SLHC 14

--- &thankyou

## Thank you!

Questions & Answers
